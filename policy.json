{
  "if": {
    "anyOf": [
      {
        "not": {
          "anyOf": [
            {
              "field": "type",
              "like": "Microsoft.KeyVault/vaults/*"
            },
            {
              "field": "type",
              "like": "Microsoft.Storage/storageAccounts/*"
            },
            {
              "field": "type",
              "like": "Microsoft.ContainerRegistry/registries/*"
            },
            {
              "field": "type",
              "like": "Microsoft.Search/searchServices/*"
            },
            {
              "field": "type",
              "like": "Microsoft.MachineLearningServices/workspaces/*"
            },
            {
              "field": "type",
              "like": "Microsoft.MachineLearningServices/workspaces/computes/*"
            }
          ]
        }
      },
      {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.KeyVault/vaults"
          },
          {
            "field": "Microsoft.KeyVault/vaults/sku.name",
            "notIn": [
              "Standard"
            ]
          }
        ]
      },
      {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.Storage/storageAccounts"
          },
          {
            "field": "Microsoft.Storage/storageAccounts/sku.name",
            "notIn": [
              "Standard_LRS"
            ]
          }
        ]
      },
      {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.ContainerRegistry/registries"
          },
          {
            "field": "Microsoft.ContainerRegistry/registries/sku.name",
            "notIn": [
              "Basic"
            ]
          }
        ]
      },
      {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.Search/searchServices"
          },
          {
            "field": "Microsoft.Search/searchServices/sku.name",
            "notIn": [
              "Basic"
            ]
          }
        ]
      },
      {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.MachineLearningServices/workspaces"
          },
          {
            "field": "Microsoft.MachineLearningServices/workspaces/sku.name",
            "notIn": [
              "Basic",
              "Enterprise"
            ]
          }
        ]
      },
      {
        "allOf": [
          {
            "field": "type",
            "like": "Microsoft.MachineLearningServices/workspaces/computes/*"
          },
          {
            "not": {
              "anyOf": [
                {
                  "field": "Microsoft.MachineLearningServices/workspaces/computes/sku.name",
                  "in": [
                    "Standard_DS11_v2"
                  ]
                },
                {
                  "field": "Microsoft.MachineLearningServices/workspaces/computes/properties.vmSize",
                  "in": [
                    "Standard_DS11_v2"
                  ]
                }
              ]
            }
          }
        ]
      }
    ]
  },
  "then": {
    "effect": "deny"
  }
}
