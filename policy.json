{
  "if": {
    "anyOf": [
      {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.KeyVault/vaults"
          },
          {
            "not": {
              "field": "Microsoft.KeyVault/vaults/sku.name",
              "in": ["Standard"]
            }
          }
        ]
      },
      {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.KeyVault/vaults"
          },
          {
            "field": "Microsoft.KeyVault/vaults.properties.enablePurgeProtection",
            "equals": true
          }
        ]
      },
      {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.Storage/storageAccounts"
          },
          {
            "not": {
              "field": "Microsoft.Storage/storageAccounts/sku.name",
              "in": ["Standard_LRS"]
            }
          }
        ]
      },
      {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.ContainerRegistry/registries"
          },
          {
            "not": {
              "field": "Microsoft.ContainerRegistry/registries/sku.name",
              "in": ["Basic"]
            }
          }
        ]
      },
      {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.Search/searchServices"
          },
          {
            "not": {
              "field": "Microsoft.Search/searchServices/sku.name",
              "in": ["Basic"]
            }
          }
        ]
      },
      {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.MachineLearningServices/workspaces"
          },
          {
            "not": {
              "field": "Microsoft.MachineLearningServices/workspaces/sku.name",
              "in": ["Basic"]
            }
          }
        ]
      },
      {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.MachineLearningServices/workspaces/computes"
          },
          {
            "not": {
              "field": "Microsoft.MachineLearningServices/workspaces/computes/sku.name",
              "in": ["Standard_DS11_v2"]
            }
          }
        ]
      },
      {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.ContainerInstance/containerGroups"
          },
          {
            "not": {
              "field": "Microsoft.ContainerInstance/containerGroups/containers[*].resources.requests.cpu",
              "in": [1]
            }
          },
          {
            "not": {
              "field": "Microsoft.ContainerInstance/containerGroups/containers[*].resources.requests.memoryInGB",
              "in": [1]
            }
          }
        ]
      }
    ]
  },
  "then": {
    "effect": "deny"
  }
}
